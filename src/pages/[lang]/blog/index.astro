---
import { getCollection } from 'astro:content';
import BlogListPage from '../../../components/blog/BlogListPage.astro';
import { getStaticPathsForLang } from '../../../i18n/utils';

type SupportedLang = 'en' | 'he';

export function getStaticPaths() {
  return getStaticPathsForLang();
}

const { lang } = Astro.params;

if (lang !== 'en' && lang !== 'he') {
  throw new Error('Unsupported locale');
}

const currentLang = lang as SupportedLang;

const blogPosts = (await getCollection('blog'))
  .filter((post) => !post.data.hidden)
  .sort(
    (a, b) => b.data.publishDate.getTime() - a.data.publishDate.getTime(),
  );
---

<BlogListPage lang={currentLang} blogPosts={blogPosts} />
